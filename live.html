<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Threats | GulfCyber.io</title>
    <meta name="description" content="Real-time ransomware threats targeting GCC organizations with actual countdown timers.">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: #0a0a0a;
            color: #e0e0e0;
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(90deg, #1a0000, #0a0a0a);
            padding: 30px;
            border-bottom: 1px solid #ff000033;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header h1 {
            font-size: 2em;
            color: #ff4444;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .live-dot {
            width: 12px;
            height: 12px;
            background: #ff0000;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 10px #ff0000; }
            50% { opacity: 0.5; box-shadow: 0 0 20px #ff0000; }
        }
        .last-updated {
            color: #666;
            font-size: 0.9em;
            margin-top: 10px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        .threat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        .threat-card {
            background: linear-gradient(145deg, #1a1a1a, #0f0f0f);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid #333;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .threat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(255,0,0,0.2);
        }
        .threat-card.critical {
            border-color: #ff0000;
            box-shadow: 0 0 20px rgba(255,0,0,0.4);
            animation: critical-pulse 2s infinite;
        }
        @keyframes critical-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255,0,0,0.4); }
            50% { box-shadow: 0 0 30px rgba(255,0,0,0.6); }
        }
        .threat-card.expired {
            opacity: 0.6;
            border-color: #444;
        }
        .threat-header {
            background: linear-gradient(90deg, #ff0000, #aa0000);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .threat-card.expired .threat-header {
            background: linear-gradient(90deg, #444, #333);
        }
        .threat-group {
            font-weight: bold;
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .threat-tag {
            background: rgba(0,0,0,0.3);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
        }
        .threat-body {
            padding: 20px;
        }
        .victim-name {
            font-size: 1.3em;
            margin-bottom: 10px;
            color: #fff;
            word-break: break-word;
        }
        .victim-meta {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        .countdown {
            background: #000;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin-top: 15px;
        }
        .countdown-label {
            color: #ff6666;
            font-size: 0.85em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .countdown-unit {
            background: #1a1a1a;
            padding: 10px 15px;
            border-radius: 8px;
            min-width: 60px;
        }
        .countdown-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #ff4444;
            font-family: monospace;
        }
        .countdown-text {
            font-size: 0.7em;
            color: #666;
            text-transform: uppercase;
        }
        .expired-label {
            color: #888;
            font-size: 1.2em;
            padding: 20px;
        }
        .stats-bar {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .stat {
            background: rgba(255,255,255,0.05);
            padding: 20px 30px;
            border-radius: 12px;
            border-left: 4px solid #ff4444;
        }
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #ff4444;
        }
        .stat-label {
            color: #888;
        }
        .no-threats {
            text-align: center;
            padding: 60px;
            color: #00ff88;
        }
        .no-threats h2 { margin-bottom: 10px; }
        .back-link {
            display: inline-block;
            margin: 30px 0;
            color: #00d4ff;
            text-decoration: none;
        }
        .disclaimer {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 0.85em;
            color: #666;
        }
        .section-title {
            font-size: 1.3em;
            color: #888;
            margin: 30px 0 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }
    </style>
<script defer data-domain="socratesowl0-del.github.io" src="https://plausible.io/js/script.js"></script>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1><span class="live-dot"></span> Live Ransomware Threats - GCC Region</h1>
            <div class="last-updated" id="lastUpdated">Loading...</div>
        </div>
    </div>
    
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Dashboard</a>
        
        <div class="stats-bar" id="stats"></div>
        
        <div id="active-section">
            <div class="threat-grid" id="threats"></div>
        </div>
        
        <div id="expired-section" style="display:none">
            <h3 class="section-title">‚è∞ Recently Expired</h3>
            <div class="threat-grid" id="expired-threats"></div>
        </div>
        
        <div class="disclaimer">
            ‚ö†Ô∏è <strong>Real data from ransomware leak sites.</strong> 
            Deadlines calculated from discovery date + threat actor patterns.
            Organizations listed should verify status and initiate incident response.
        </div>
    </div>

    <script>
        let threatData = null;
        
        async function loadThreats() {
            try {
                const res = await fetch('live-threats.json');
                threatData = await res.json();
                renderThreats();
                
                // Update every minute
                setInterval(updateCountdowns, 1000);
            } catch (e) {
                console.error(e);
                document.getElementById('threats').innerHTML = '<p>Failed to load - try refreshing</p>';
            }
        }

        function renderThreats() {
            const data = threatData;
            const threats = data.threats || [];
            const expired = data.recently_expired || [];
            
            // Update header
            document.getElementById('lastUpdated').textContent = 
                `Last updated: ${new Date(data.updated).toLocaleString()}`;
            
            // Stats
            const activeCount = threats.filter(t => !t.is_expired).length;
            const criticalCount = threats.filter(t => t.hours_remaining < 48 && !t.is_expired).length;
            
            document.getElementById('stats').innerHTML = `
                <div class="stat">
                    <div class="stat-value">${activeCount}</div>
                    <div class="stat-label">Active Threats</div>
                </div>
                <div class="stat">
                    <div class="stat-value" style="color: ${criticalCount > 0 ? '#ff0000' : '#ff4444'}">${criticalCount}</div>
                    <div class="stat-label">Critical (&lt;48h)</div>
                </div>
            `;
            
            if (threats.length === 0) {
                document.getElementById('threats').innerHTML = `
                    <div class="no-threats">
                        <h2>‚úÖ No Active Threats</h2>
                        <p>No active ransomware deadlines for GCC region</p>
                    </div>
                `;
                return;
            }
            
            // Render active threats
            const activeThreats = threats.filter(t => !t.is_expired);
            document.getElementById('threats').innerHTML = activeThreats.map((t, i) => 
                renderThreatCard(t, i, false)
            ).join('');
            
            // Render expired if any
            if (expired.length > 0) {
                document.getElementById('expired-section').style.display = 'block';
                document.getElementById('expired-threats').innerHTML = expired.map((t, i) => 
                    renderThreatCard(t, i + 100, true)
                ).join('');
            }
        }
        
        function renderThreatCard(t, idx, isExpired) {
            const isCritical = t.hours_remaining < 48 && !isExpired;
            
            return `
                <div class="threat-card ${isCritical ? 'critical' : ''} ${isExpired ? 'expired' : ''}" 
                     data-deadline="${t.deadline_timestamp}" id="card-${idx}">
                    <div class="threat-header">
                        <span class="threat-group">${t.group || 'Unknown'}</span>
                        <span class="threat-tag">${t.country || 'GCC'}</span>
                    </div>
                    <div class="threat-body">
                        <div class="victim-name">${t.name || 'Unknown Organization'}</div>
                        <div class="victim-meta">
                            üìÖ Discovered: ${t.discovered ? t.discovered.split('T')[0] : 'Unknown'}<br>
                            ${t.sector ? `üè¢ Sector: ${t.sector}` : ''}
                        </div>
                        ${isExpired ? 
                            '<div class="expired-label">‚è∞ Deadline passed - Data likely leaked</div>' :
                            `<div class="countdown">
                                <div class="countdown-label">‚ö†Ô∏è Data Leak Deadline</div>
                                <div class="countdown-timer" id="timer-${idx}">
                                    <div class="countdown-unit">
                                        <div class="countdown-number days">--</div>
                                        <div class="countdown-text">Days</div>
                                    </div>
                                    <div class="countdown-unit">
                                        <div class="countdown-number hours">--</div>
                                        <div class="countdown-text">Hours</div>
                                    </div>
                                    <div class="countdown-unit">
                                        <div class="countdown-number mins">--</div>
                                        <div class="countdown-text">Mins</div>
                                    </div>
                                    <div class="countdown-unit">
                                        <div class="countdown-number secs">--</div>
                                        <div class="countdown-text">Secs</div>
                                    </div>
                                </div>
                            </div>`
                        }
                    </div>
                </div>
            `;
        }
        
        function updateCountdowns() {
            document.querySelectorAll('.threat-card:not(.expired)').forEach(card => {
                const deadline = parseInt(card.dataset.deadline);
                const now = Date.now();
                const diff = deadline - now;
                
                const idx = card.id.replace('card-', '');
                const timer = document.getElementById(`timer-${idx}`);
                
                if (!timer) return;
                
                if (diff > 0) {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const secs = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    timer.querySelector('.days').textContent = days.toString().padStart(2, '0');
                    timer.querySelector('.hours').textContent = hours.toString().padStart(2, '0');
                    timer.querySelector('.mins').textContent = mins.toString().padStart(2, '0');
                    timer.querySelector('.secs').textContent = secs.toString().padStart(2, '0');
                } else {
                    timer.innerHTML = '<div class="expired-label">‚è∞ EXPIRED</div>';
                    card.classList.add('expired');
                }
            });
        }
        
        loadThreats();
    </script>
</body>
</html>
